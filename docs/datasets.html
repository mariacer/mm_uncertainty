
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Datasets &#8212; regression_uncertainty_mm 0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utilities" href="utils.html" />
    <link rel="prev" title="Probabilistic" href="probabilistic.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="datasets">
<span id="datasets-reference-label"></span><h1><a class="toc-backref" href="#id3">Datasets</a><a class="headerlink" href="#datasets" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#datasets" id="id3">Datasets</a></p>
<ul>
<li><p><a class="reference internal" href="#module-data.regression1d_heteroscedastic_data" id="id4">API</a></p>
<ul>
<li><p><a class="reference internal" href="#d-regression-dataset-with-heteroscedastic-laplace-error" id="id5">1D Regression Dataset with heteroscedastic Laplace error</a></p></li>
<li><p><a class="reference internal" href="#d-regression-dataset-with-bimodal-gaussian-error" id="id6">2D Regression Dataset with bimodal Gaussian Error</a></p></li>
<li><p><a class="reference internal" href="#d-regression-dataset-with-gaussian-error" id="id7">2D Regression Dataset with Gaussian Error</a></p></li>
<li><p><a class="reference internal" href="#helper-functions-for-generating-different-datasets" id="id8">Helper functions for generating different datasets</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>This module contains all relevant functions to generate datasets.</p>
<div class="section" id="module-data.regression1d_heteroscedastic_data">
<span id="api"></span><h2><a class="toc-backref" href="#id4">API</a><a class="headerlink" href="#module-data.regression1d_heteroscedastic_data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="d-regression-dataset-with-heteroscedastic-laplace-error">
<h3><a class="toc-backref" href="#id5">1D Regression Dataset with heteroscedastic Laplace error</a><a class="headerlink" href="#d-regression-dataset-with-heteroscedastic-laplace-error" title="Permalink to this headline">¶</a></h3>
<p>The module <code class="xref py py-mod docutils literal notranslate"><span class="pre">data.special.regression1d_bimodal_data</span></code> contains a data handler
for a CL toy regression problem. The user can construct individual datasets with
this data handler and use each of these datasets to train a model in a continual
learning setting.</p>
<dl class="class">
<dt id="data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression">
<em class="property">class </em><code class="sig-prename descclassname">data.regression1d_heteroscedastic_data.</code><code class="sig-name descname">HeteroscedasticToyRegression</code><span class="sig-paren">(</span><em class="sig-param">train_inter=[-10, 10], num_train=20, test_inter=[-10, 10], num_test=80, val_inter=None, num_val=None, map_function=&lt;function HeteroscedasticToyRegression.&lt;lambda&gt;&gt;, scale=0, factor=5, rseed=None, perturb_test_val=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/regression1d_heteroscedastic_data.html#HeteroscedasticToyRegression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">hypnettorch.data.special.regression1d_data.ToyRegression</span></code></p>
<p>An instance of this class shall represent a simple regression task, but
with a heteroscedastic Laplace error distribution.</p>
<dl class="attribute">
<dt id="data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.train_x_range">
<code class="sig-name descname">train_x_range</code><a class="headerlink" href="#data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.train_x_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The input range for training samples.</p>
</dd></dl>

<dl class="attribute">
<dt id="data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.test_x_range">
<code class="sig-name descname">test_x_range</code><a class="headerlink" href="#data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.test_x_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The input range for test samples.</p>
</dd></dl>

<dl class="attribute">
<dt id="data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.val_x_range">
<code class="sig-name descname">val_x_range</code><a class="headerlink" href="#data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.val_x_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The input range for validation samples.</p>
</dd></dl>

<p>Generate a new dataset.</p>
<p>The input data x will be uniformly drawn for train samples and
equidistant for test samples. The user has to specify a function that
will map this random input data onto output samples y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_inter</strong> – A tuple, representing the interval from which x
samples are drawn in the training set. Note, this range will
apply to all input dimensions.</p></li>
<li><p><strong>num_train</strong> – Number of training samples.</p></li>
<li><p><strong>test_inter</strong> – A tuple, representing the interval from which x
samples are drawn in the test set. Note, this range will
apply to all input dimensions.</p></li>
<li><p><strong>num_test</strong> – Number of test samples.</p></li>
<li><p><strong>val_inter</strong> (<em>optional</em>) – See parameter <cite>test_inter</cite>. If set, this
argument leads to the construction of a validation set. Note,
option <cite>num_val</cite> need to be specified as well.</p></li>
<li><p><strong>num_val</strong> (<em>optional</em>) – Number of validation samples.</p></li>
<li><p><strong>map_function</strong> – A function handle that receives input
samples and maps them to output samples.</p></li>
<li><p><strong>scale</strong> – If not zero, Laplace white noise with this scale will be
added to the training outputs.</p></li>
<li><p><strong>factor</strong> – The std of the noise will be this many times larger at the
right side of the data as on the left side.</p></li>
<li><p><strong>rseed</strong> – If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the current random state of numpy is used to
generate the data. Otherwise, a new random state with the
given seed is generated.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.f">
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/regression1d_heteroscedastic_data.html#HeteroscedasticToyRegression.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.f" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.get_identifier">
<code class="sig-name descname">get_identifier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/regression1d_heteroscedastic_data.html#HeteroscedasticToyRegression.get_identifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.get_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the dataset.</p>
</dd></dl>

<dl class="method">
<dt id="data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.plot_datasets">
<em class="property">static </em><code class="sig-name descname">plot_datasets</code><span class="sig-paren">(</span><em class="sig-param">data_handlers</em>, <em class="sig-param">inputs=None</em>, <em class="sig-param">predictions=None</em>, <em class="sig-param">labels=None</em>, <em class="sig-param">fun_xranges=None</em>, <em class="sig-param">show=True</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">figsize=(10</em>, <em class="sig-param">6)</em>, <em class="sig-param">publication_style=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/regression1d_heteroscedastic_data.html#HeteroscedasticToyRegression.plot_datasets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.regression1d_heteroscedastic_data.HeteroscedasticToyRegression.plot_datasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot several datasets of this class in one plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_handlers</strong> – A list of ToyRegression objects.</p></li>
<li><p><strong>inputs</strong> (<em>optional</em>) – A list of numpy arrays representing inputs for
each dataset.</p></li>
<li><p><strong>predictions</strong> (<em>optional</em>) – A list of numpy arrays containing the
predicted output values for the given input values.</p></li>
<li><p><strong>labels</strong> (<em>optional</em>) – A label for each dataset.</p></li>
<li><p><strong>fun_xranges</strong> (<em>optional</em>) – List of x ranges in which the true
underlying function per dataset should be sketched.</p></li>
<li><p><strong>show</strong> – Whether the plot should be shown.</p></li>
<li><p><strong>filename</strong> (<em>optional</em>) – If provided, the figure will be stored under
this filename.</p></li>
<li><p><strong>figsize</strong> – A tuple, determining the size of the figure in inches.</p></li>
<li><p><strong>publication_style</strong> – Whether the plots should be in publication style.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-data.regression2d_bimodal"></span><div class="section" id="d-regression-dataset-with-bimodal-gaussian-error">
<h3><a class="toc-backref" href="#id6">2D Regression Dataset with bimodal Gaussian Error</a><a class="headerlink" href="#d-regression-dataset-with-bimodal-gaussian-error" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="data.regression2d_bimodal.BivariateBimodalRegression">
<em class="property">class </em><code class="sig-prename descclassname">data.regression2d_bimodal.</code><code class="sig-name descname">BivariateBimodalRegression</code><span class="sig-paren">(</span><em class="sig-param">train_inter=[-10, 10], num_train=20, test_inter=[-10, 10], num_test=80, val_inter=None, num_val=None, map_function=&lt;function BivariateBimodalRegression.&lt;lambda&gt;&gt;, cov=array([5. , 0.5]), offset=2, rot_angle=0.78, rseed=None, perturb_test_val=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/regression2d_bimodal.html#BivariateBimodalRegression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.regression2d_bimodal.BivariateBimodalRegression" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#data.regression2d_gaussian.BivariateToyRegression" title="data.regression2d_gaussian.BivariateToyRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">data.regression2d_gaussian.BivariateToyRegression</span></code></a></p>
<p>Generate a new regression dataset
from scalar x to depending bivariate y.</p>
<p>The input data x will be uniformly drawn for train samples and
equidistant for test samples. The user has to specify a function that
will map this random input data onto output samples y.</p>
<p>Default parameters for the noise give a bimodal distribution that
looks marginally gaussian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_inter</strong> – A tuple, representing the interval from which x
samples are drawn in the training set. Note, this range will
apply to all input dimensions.</p></li>
<li><p><strong>num_train</strong> – Number of training samples.</p></li>
<li><p><strong>test_inter</strong> – A tuple, representing the interval from which x
samples are drawn in the test set. Note, this range will
apply to all input dimensions.</p></li>
<li><p><strong>num_test</strong> – Number of test samples.</p></li>
<li><p><strong>val_inter</strong> (<em>optional</em>) – See parameter <cite>test_inter</cite>. If set, this
argument leads to the construction of a validation set. Note,
option <cite>num_val</cite> need to be specified as well.</p></li>
<li><p><strong>num_val</strong> (<em>optional</em>) – Number of validation samples.</p></li>
<li><p><strong>map_function</strong> – A function handle that receives input
samples and maps them to output samples.</p></li>
<li><p><strong>cov</strong> – If not zero, Gaussian white noise with this covariance will
be added to the training outputs.
If scalar, the covariance is the identity scaled by cov.
If 2d, the covariance is diag(cov).
If 2x2, cov is the covariance.</p></li>
<li><p><strong>offset</strong> – Noise will have two modes with means symmetrical to y=0
separated with means located at <img class="math" src="_images/math/6e42487c37b7254cde71af13d5b1cd699adcbd44.png" alt="y = \pm offset"/>
prior to rotation by :param rot_angle:.</p></li>
<li><p><strong>rot_angle</strong> – Rotation angle by which to rotate the noise vector.</p></li>
<li><p><strong>rseed</strong> – If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the current random state of numpy is used to
generate the data. Otherwise, a new random state with the
given seed is generated.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="data.regression2d_bimodal.BivariateBimodalRegression.cov_matrix">
<em class="property">property </em><code class="sig-name descname">cov_matrix</code><a class="headerlink" href="#data.regression2d_bimodal.BivariateBimodalRegression.cov_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Covariance matrix of each mode. Covariance is the same for both modes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is not the covariance input during initialization.
This is the covariance obtained after rotating the noise modes.
It relates to the input covariance through:
.. math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cov</span> \<span class="n">leftarrow</span> <span class="n">R</span>        <span class="n">imes</span> <span class="n">cov</span>        <span class="n">imes</span> <span class="n">R</span><span class="o">^</span><span class="n">T</span>
</pre></div>
</div>
<p>where <img class="math" src="_images/math/1ebe654cc7b8f2a0d8100aa5825cf2b9021adbbc.png" alt="R"/> is the rotation matrix obtained from the specified
rotation angle and can be obtained through <a href="#id1"><span class="problematic" id="id2">:property:`rot_matrix`</span></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="data.regression2d_bimodal.BivariateBimodalRegression.mean_mode1">
<em class="property">property </em><code class="sig-name descname">mean_mode1</code><a class="headerlink" href="#data.regression2d_bimodal.BivariateBimodalRegression.mean_mode1" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean of first mode. (2D position vector)</p>
</dd></dl>

<dl class="method">
<dt id="data.regression2d_bimodal.BivariateBimodalRegression.mean_mode2">
<em class="property">property </em><code class="sig-name descname">mean_mode2</code><a class="headerlink" href="#data.regression2d_bimodal.BivariateBimodalRegression.mean_mode2" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean of second mode. (2D position vector)</p>
</dd></dl>

<dl class="method">
<dt id="data.regression2d_bimodal.BivariateBimodalRegression.offset">
<em class="property">property </em><code class="sig-name descname">offset</code><a class="headerlink" href="#data.regression2d_bimodal.BivariateBimodalRegression.offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Half the distance between the two modes means.</p>
</dd></dl>

<dl class="method">
<dt id="data.regression2d_bimodal.BivariateBimodalRegression.rot_angle">
<em class="property">property </em><code class="sig-name descname">rot_angle</code><a class="headerlink" href="#data.regression2d_bimodal.BivariateBimodalRegression.rot_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotation angle of the noise distribution around its symmetry center.</p>
</dd></dl>

<dl class="method">
<dt id="data.regression2d_bimodal.BivariateBimodalRegression.rot_matrix">
<em class="property">property </em><code class="sig-name descname">rot_matrix</code><a class="headerlink" href="#data.regression2d_bimodal.BivariateBimodalRegression.rot_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>2D rotation matrix corresponding to the specified rotation angle
by which the noise distribution is rotated.</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-data.regression2d_gaussian"></span><div class="section" id="d-regression-dataset-with-gaussian-error">
<h3><a class="toc-backref" href="#id7">2D Regression Dataset with Gaussian Error</a><a class="headerlink" href="#d-regression-dataset-with-gaussian-error" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="data.regression2d_gaussian.BivariateToyRegression">
<em class="property">class </em><code class="sig-prename descclassname">data.regression2d_gaussian.</code><code class="sig-name descname">BivariateToyRegression</code><span class="sig-paren">(</span><em class="sig-param">train_inter=[-10, 10], num_train=20, test_inter=[-10, 10], num_test=80, val_inter=None, num_val=None, map_function=&lt;function BivariateToyRegression.&lt;lambda&gt;&gt;, cov=0, rseed=None, perturb_test_val=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/regression2d_gaussian.html#BivariateToyRegression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.regression2d_gaussian.BivariateToyRegression" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">hypnettorch.data.dataset.Dataset</span></code></p>
<p>Generate a new regression dataset
from scalar x to depending bivariate y.</p>
<p>The input data x will be uniformly drawn for train samples and
equidistant for test samples. The user has to specify a function that
will map this random input data onto output samples y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_inter</strong> – A tuple, representing the interval from which x
samples are drawn in the training set. Note, this range will
apply to all input dimensions.</p></li>
<li><p><strong>num_train</strong> – Number of training samples.</p></li>
<li><p><strong>test_inter</strong> – A tuple, representing the interval from which x
samples are drawn in the test set. Note, this range will
apply to all input dimensions.</p></li>
<li><p><strong>num_test</strong> – Number of test samples.</p></li>
<li><p><strong>val_inter</strong> (<em>optional</em>) – See parameter <cite>test_inter</cite>. If set, this
argument leads to the construction of a validation set. Note,
option <cite>num_val</cite> need to be specified as well.</p></li>
<li><p><strong>num_val</strong> (<em>optional</em>) – Number of validation samples.</p></li>
<li><p><strong>map_function</strong> – A function handle that receives input
samples and maps them to output samples.</p></li>
<li><p><strong>cov</strong> – If not zero, Gaussian white noise with this covariance will
be added to the training outputs.
If scalar, the covariance is the identity scaled by cov.
If 2d, the covariance is diag(cov).
If 2x2, cov is the covariance.</p></li>
<li><p><strong>rseed</strong> – If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the current random state of numpy is used to
generate the data. Otherwise, a new random state with the
given seed is generated.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="data.regression2d_gaussian.BivariateToyRegression.cov_matrix">
<em class="property">property </em><code class="sig-name descname">cov_matrix</code><a class="headerlink" href="#data.regression2d_gaussian.BivariateToyRegression.cov_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Covariance matrix.</p>
</dd></dl>

<dl class="method">
<dt id="data.regression2d_gaussian.BivariateToyRegression.get_identifier">
<code class="sig-name descname">get_identifier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/regression2d_gaussian.html#BivariateToyRegression.get_identifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.regression2d_gaussian.BivariateToyRegression.get_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns name of dataset</p>
</dd></dl>

<dl class="method">
<dt id="data.regression2d_gaussian.BivariateToyRegression.plot_dataset">
<code class="sig-name descname">plot_dataset</code><span class="sig-paren">(</span><em class="sig-param">show=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/regression2d_gaussian.html#BivariateToyRegression.plot_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.regression2d_gaussian.BivariateToyRegression.plot_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO</p>
</dd></dl>

<dl class="method">
<dt id="data.regression2d_gaussian.BivariateToyRegression.test_x_range">
<em class="property">property </em><code class="sig-name descname">test_x_range</code><a class="headerlink" href="#data.regression2d_gaussian.BivariateToyRegression.test_x_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The input range for test samples.</p>
</dd></dl>

<dl class="method">
<dt id="data.regression2d_gaussian.BivariateToyRegression.train_x_range">
<em class="property">property </em><code class="sig-name descname">train_x_range</code><a class="headerlink" href="#data.regression2d_gaussian.BivariateToyRegression.train_x_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The input range for training samples.</p>
</dd></dl>

<dl class="method">
<dt id="data.regression2d_gaussian.BivariateToyRegression.val_x_range">
<em class="property">property </em><code class="sig-name descname">val_x_range</code><a class="headerlink" href="#data.regression2d_gaussian.BivariateToyRegression.val_x_range" title="Permalink to this definition">¶</a></dt>
<dd><p>The input range for validation samples.</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-data.data_utils"></span><div class="section" id="helper-functions-for-generating-different-datasets">
<h3><a class="toc-backref" href="#id8">Helper functions for generating different datasets</a><a class="headerlink" href="#helper-functions-for-generating-different-datasets" title="Permalink to this headline">¶</a></h3>
<p>A collection of helper functions for generating datasets to keep other scripts
clean.</p>
<dl class="function">
<dt id="data.data_utils.compute_1D_uncertainty_stats">
<code class="sig-prename descclassname">data.data_utils.</code><code class="sig-name descname">compute_1D_uncertainty_stats</code><span class="sig-paren">(</span><em class="sig-param">config</em>, <em class="sig-param">writer</em>, <em class="sig-param">data</em>, <em class="sig-param">mnet</em>, <em class="sig-param">device</em>, <em class="sig-param">hnet=None</em>, <em class="sig-param">log_likelihood=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/data_utils.html#compute_1D_uncertainty_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_utils.compute_1D_uncertainty_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute uncertainty statistics for 1D toy regression experiments.</p>
<p>In particular, this function computes the mean, the variance, the entropy,
the multi-modality score and the model disagreement (for Bayesian models)
at a specific input location determined by the input <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – Command-line arguments.</p></li>
<li><p><strong>writer</strong> – Tensorboard summary writer.</p></li>
<li><p><strong>data</strong> – A data loader.</p></li>
<li><p><strong>mnet</strong> – The network.</p></li>
<li><p><strong>device</strong> – The cuda device.</p></li>
<li><p><strong>hnet</strong> – The (optional) hypernetwork. Provided when the model is a NF.</p></li>
<li><p><strong>log_likelihood</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to plot the likelihood in a log scale.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary with all relevant statistics at the requested point.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.data_utils.compute_model_disagreement">
<code class="sig-prename descclassname">data.data_utils.</code><code class="sig-name descname">compute_model_disagreement</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/data_utils.html#compute_model_disagreement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_utils.compute_model_disagreement" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the model disagreement.</p>
<p>The model disagreement is computed here as standard deviation of the
parameters of the likelihood averaged over the dimensionality of the space
to obtain a scalar. In the manuscript it is called $mathcal{U}_V(x)$.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<em>torch.tensor</em>) – This are the parameters of the likelihood model.
- Mean for GLc
- Mean and variance concatenated for GL
- Weights for the Normalizing flow model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The model disagreement.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.data_utils.compute_multimodality_score">
<code class="sig-prename descclassname">data.data_utils.</code><code class="sig-name descname">compute_multimodality_score</code><span class="sig-paren">(</span><em class="sig-param">z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/data_utils.html#compute_multimodality_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_utils.compute_multimodality_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the uni-modality score of the predictive distribution.</p>
<p>Fits a mixture of two Gaussians to the input samples and
tests the resulting mixture for unimodality and
returns scores of unimodality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>z</strong> (<em>np.array</em>) – The predictions at the origin for different y values,
averaged across models.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The mixing factor between the two Gaussians.
d (float): A score of the overlap between the two Gaussians.</p>
<blockquote>
<div><p>The formula is given by:
..math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> \<span class="n">frac</span><span class="p">{</span><span class="o">|</span>\<span class="n">mu_1</span><span class="o">-</span>\<span class="n">mu_2</span><span class="o">|</span><span class="p">}{</span><span class="mi">2</span>\<span class="n">sqrt</span><span class="p">{</span>\<span class="n">sigma_1</span> \<span class="n">sigma_2</span><span class="p">}}</span>
</pre></div>
</div>
</div></blockquote>
<p>is_unimodal (bool): Whether the mixture is unimodal.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>p (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.data_utils.generate_task">
<code class="sig-prename descclassname">data.data_utils.</code><code class="sig-name descname">generate_task</code><span class="sig-paren">(</span><em class="sig-param">config</em>, <em class="sig-param">writer</em>, <em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/data_utils.html#generate_task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_utils.generate_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a set of user defined tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – Command-line arguments.</p></li>
<li><p><strong>writer</strong> – Tensorboard writer, in case plots should be logged.</p></li>
<li><p><strong>dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The name of the dataset to be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple containing:</p>
<ul class="simple">
<li><dl class="simple">
<dt><strong>data_struct</strong>: The data structure and data handler (for non</dt><dd><p>steering angle experiments).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>tuple</strong>: For the steering angle dataset, a tuple with train,</dt><dd><p>validation and test loaders.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(…)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.data_utils.load_image">
<code class="sig-prename descclassname">data.data_utils.</code><code class="sig-name descname">load_image</code><span class="sig-paren">(</span><em class="sig-param">image_path</em>, <em class="sig-param">folder_path='../data/splitting_lane_images/'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/data_utils.html#load_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_utils.load_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a certain image and make it suitable for torch processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The path to the container folder. Note that this
folder needs to have subfolders for images to be properly loaded.</p></li>
<li><p><strong>image_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The path to the image within the container folder.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.data_utils.open_udacity_ch2">
<code class="sig-prename descclassname">data.data_utils.</code><code class="sig-name descname">open_udacity_ch2</code><span class="sig-paren">(</span><em class="sig-param">config</em>, <em class="sig-param">create_train_loader=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/data_utils.html#open_udacity_ch2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_utils.open_udacity_ch2" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the UdacityCh2 dataset and create the corresponding dataloaders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – Command-line options.</p></li>
<li><p><strong>batch_size</strong> – Batchsize for all data loaders.</p></li>
<li><p><strong>create_train_loader</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether a loader for the training set should
be generated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple containing:</p>
<p><code class="docutils literal notranslate"><span class="pre">[data_handler,</span> <span class="pre">train_loader,</span> <span class="pre">val_loader,</span> <span class="pre">test_loader]</span></code>
Note, <code class="docutils literal notranslate"><span class="pre">train_loader</span></code> and <code class="docutils literal notranslate"><span class="pre">val_loader</span></code> might be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="data.data_utils.parse_cov_matrix">
<code class="sig-prename descclassname">data.data_utils.</code><code class="sig-name descname">parse_cov_matrix</code><span class="sig-paren">(</span><em class="sig-param">cov_str</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/data_utils.html#parse_cov_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_utils.parse_cov_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a command line string cov matrix into a list of floats.</p>
</dd></dl>

<dl class="function">
<dt id="data.data_utils.test_splitting_image">
<code class="sig-prename descclassname">data.data_utils.</code><code class="sig-name descname">test_splitting_image</code><span class="sig-paren">(</span><em class="sig-param">mnet</em>, <em class="sig-param">data</em>, <em class="sig-param">device</em>, <em class="sig-param">config</em>, <em class="sig-param">shared</em>, <em class="sig-param">logger</em>, <em class="sig-param">writer</em>, <em class="sig-param">mode</em>, <em class="sig-param">hnet=None</em>, <em class="sig-param">epoch=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data/data_utils.html#test_splitting_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data.data_utils.test_splitting_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the networks on an image with splitting lanes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mnet</strong> – The main network.</p></li>
<li><p><strong>device</strong> – The device.</p></li>
<li><p><strong>config</strong> – The configuration.</p></li>
<li><p><strong>shared</strong> – Namespace with useful information.</p></li>
<li><p><strong>logger</strong> – The logger.</p></li>
<li><p><strong>writer</strong> – The tensorboard writer.</p></li>
<li><p><strong>mode</strong> – The mode of the experiment (<cite>gl</cite>, <cite>ghl</cite> or <cite>nf</cite>).</p></li>
<li><p><strong>hnet</strong> – The (optional) hypernetwork.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">regression_uncertainty_mm</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents of this repository:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gaussian_likelihoods.html">Gaussian Likelihoods</a></li>
<li class="toctree-l1"><a class="reference internal" href="norm_flow.html">Normalizing Flows</a></li>
<li class="toctree-l1"><a class="reference internal" href="networks.html">Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="probabilistic.html">Probabilistic</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-data.regression1d_heteroscedastic_data">API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="probabilistic.html" title="previous chapter">Probabilistic</a></li>
      <li>Next: <a href="utils.html" title="next chapter">Utilities</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Maria R. Cervera, Rafael Daetwyler, Hamza Keurti, Francesco dAngelo, Christian Henning.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/datasets.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>